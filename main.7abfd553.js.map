{"version":3,"sources":["scripts/main.js"],"names":["winning","score","field","buttonAction","document","querySelector","messages","querySelectorAll","messageLose","messageWin","gameScore","fieldLength","up","down","left","right","addNewNumber","includesZero","row","randomNumber","indexOf","allIndexZero","reduce","acc","el","i","push","randomZero","length","rowIndex","max","Math","floor","random","render","cell","innerHTML","classList","remove","isGameOver","j","index","className","moveLeft","filterZero","addZeros","summationNumbers","moveRight","moveUp","column","l","moveDown","arr","filter","num","reverse","unshift","isWinning","hideAllMessages","forEach","message","add","haveZero","includes","number","addEventListener","e","code"],"mappings":"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","file":"main.7abfd553.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nconst buttonAction = document.querySelector('.button');\nconst messages = document.querySelectorAll('.message');\nconst messageLose = document.querySelector('.message-lose');\nconst messageWin = document.querySelector('.message-win');\nconst gameScore = document.querySelector('.game-score');\nconst fieldLength = 4;\nconst up = 'ArrowUp';\nconst down = 'ArrowDown';\nconst left = 'ArrowLeft';\nconst right = 'ArrowRight';\nlet winning;\nlet score;\nlet field;\n\nbuttonAction.addEventListener('click', () => {\n  score = 0;\n  winning = false;\n\n  field = [\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n    [0, 0, 0, 0],\n  ];\n\n  addNewNumber();\n  addNewNumber();\n\n  hideAllMessages();\n\n  buttonAction.innerHTML = 'Reset';\n  buttonAction.classList.remove('start');\n  buttonAction.classList.add('restart');\n\n  render();\n});\n\nfunction addNewNumber() {\n  if (includesZero()) {\n    let row = field[randomNumber(4)];\n\n    while (row.indexOf(0) === -1) {\n      row = field[randomNumber(4)];\n    }\n\n    const allIndexZero = row.reduce((acc, el, i) => {\n      if (el === 0) {\n        acc.push(i);\n      }\n\n      return acc;\n    }, []);\n\n    const randomZero = allIndexZero[randomNumber(allIndexZero.length)];\n    const rowIndex = field.indexOf(row);\n\n    field[rowIndex][randomZero] = randomNumber();\n  }\n}\n\nfunction randomNumber(max) {\n  if (!max) {\n    return Math.random() < 0.2 ? 4 : 2;\n  }\n\n  return Math.floor(Math.random() * max);\n}\n\nfunction render() {\n  const cell = document.querySelectorAll('.field-cell');\n\n  gameScore.innerHTML = score;\n\n  if (winning) {\n    messageWin.classList.remove('hidden');\n  }\n\n  if (!includesZero() && isGameOver()) {\n    messageLose.classList.remove('hidden');\n  }\n\n  for (let i = 0; i < fieldLength; i++) {\n    for (let j = 0; j < fieldLength; j++) {\n      const index = i * fieldLength + j;\n\n      if (field[i][j] !== 0) {\n        cell[index].innerHTML = field[i][j];\n\n        cell[index].className = `\n          field-cell field-cell--show field-cell--${field[i][j]}\n        `;\n      } else {\n        cell[index].innerHTML = '';\n        cell[index].className = 'field-cell';\n      }\n    }\n  }\n}\n\ndocument.addEventListener('keyup', (e) => {\n  switch (e.code) {\n    case up:\n      moveUp();\n      break;\n\n    case down:\n      moveDown();\n      break;\n\n    case left:\n      moveLeft();\n      break;\n\n    case right:\n      moveRight();\n      break;\n\n    default:\n      break;\n  }\n\n  render();\n  addNewNumber();\n  render();\n});\n\nfunction moveLeft() {\n  for (let i = 0; i < fieldLength; i++) {\n    let row = filterZero(field[i]);\n\n    addZeros(row);\n\n    summationNumbers(row);\n\n    row = filterZero(row);\n\n    addZeros(row);\n\n    field[i] = row;\n  }\n};\n\nfunction moveRight() {\n  for (let i = 0; i < fieldLength; i++) {\n    let row = filterZero(field[i]);\n\n    addZeros(row, 'reverse');\n\n    summationNumbers(row, 'reverse');\n\n    row = filterZero(row);\n\n    addZeros(row, 'reverse');\n\n    field[i] = row;\n  }\n};\n\nfunction moveUp() {\n  for (let i = 0; i < fieldLength; i++) {\n    let column = [];\n\n    for (let j = 0; j < fieldLength; j++) {\n      column.push(field[j][i]);\n    }\n\n    column = filterZero(column);\n\n    addZeros(column);\n\n    summationNumbers(column);\n\n    column = filterZero(column);\n\n    addZeros(column);\n\n    for (let l = 0; l < fieldLength; l++) {\n      field[l][i] = column[l];\n    }\n  }\n};\n\nfunction moveDown() {\n  for (let i = 0; i < fieldLength; i++) {\n    let column = [];\n\n    for (let j = 0; j < fieldLength; j++) {\n      column.push(field[j][i]);\n    }\n\n    column = filterZero(column);\n\n    addZeros(column, 'reverse');\n\n    summationNumbers(column, 'reverse');\n\n    column = filterZero(column);\n\n    addZeros(column, 'reverse');\n\n    for (let l = 0; l < fieldLength; l++) {\n      field[l][i] = column[l];\n    }\n  }\n};\n\nfunction filterZero(arr) {\n  return arr.filter(num => num !== 0);\n}\n\nfunction addZeros(arr, reverse) {\n  if (reverse) {\n    while (arr.length < 4) {\n      arr.unshift(0);\n    }\n  } else {\n    while (arr.length < 4) {\n      arr.push(0);\n    }\n  }\n}\n\nfunction summationNumbers(arr, reverse) {\n  if (reverse) {\n    for (let i = fieldLength - 1; i >= 0; i--) {\n      if (arr[i] === arr[i - 1] && arr[i] !== 0) {\n        arr[i] += arr[i - 1];\n        isWinning(arr[i]);\n        arr[i - 1] = 0;\n        score += arr[i];\n      }\n    }\n  } else {\n    for (let i = 0; i < fieldLength - 1; i++) {\n      if (arr[i] === arr[i + 1] && arr[i] !== 0) {\n        arr[i] += arr[i + 1];\n        isWinning(arr[i]);\n        arr[i + 1] = 0;\n        score += arr[i];\n      }\n    }\n  }\n}\n\nfunction hideAllMessages() {\n  messages.forEach(message => message.classList.add('hidden'));\n}\n\nfunction includesZero() {\n  let haveZero = false;\n\n  for (let i = 0; i < fieldLength; i++) {\n    if (field[i].includes(0)) {\n      haveZero = true;\n      break;\n    }\n  }\n\n  return haveZero;\n}\n\nfunction isGameOver() {\n  for (let i = 0; i < fieldLength; i++) {\n    for (let j = 0; j < fieldLength - 1; j++) {\n      if (field[i][j] === field[i][j + 1]) {\n        return false;\n      }\n    }\n  }\n\n  for (let i = 0; i < fieldLength - 1; i++) {\n    for (let j = 0; j < fieldLength; j++) {\n      if (field[i][j] === field[i + 1][j]) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction isWinning(number) {\n  if (number === 2048) {\n    winning = true;\n  }\n};\n"]}